import{d as q,k as C,a as o,t as c,j as s,e as E,B as T,L as V,h as l,V as m}from"./index-Ck2EgO-1.js";import{a as y}from"./index-xsH4HHeE.js";import{I as P}from"./Input-B-VVxmdA.js";import{C as $}from"./Card-DdUEfcKR.js";const U=()=>{const i=q(),p=C(),[b,j]=o.useState(""),[a,v]=o.useState({password:"",confirmPassword:""}),[u,f]=o.useState({}),[d,x]=o.useState(!1),[D,k]=o.useState(!1),[N,S]=o.useState(!0);o.useEffect(()=>{const r=new URLSearchParams(p.search).get("token");if(!r){c.error("Invalid or missing reset token"),i("/forgot-password");return}(async()=>{try{await y.get(`${l.base}${l.auth.resetPassword}?token=${r}`),j(r),k(!0)}catch{c.error("Invalid or expired reset token"),i("/forgot-password")}finally{S(!1)}})()},[p,i]);const h=e=>{const{name:r,value:n}=e.target;v(t=>({...t,[r]:n})),u[r]&&f(t=>({...t,[r]:""}))},I=()=>{const e={};return a.password?a.password.length<8&&(e.password=m.password.minLength):e.password=m.required,a.confirmPassword?a.password!==a.confirmPassword&&(e.confirmPassword=m.match):e.confirmPassword=m.required,f(e),Object.keys(e).length===0},L=async e=>{var r,n,t,g;if(e.preventDefault(),!!I()){x(!0);try{await y.post(`${l.base}${l.auth.resetPassword}`,{token:b,password:a.password}),c.success("Password reset successful!"),i("/login")}catch(w){const R=((n=(r=w.response)==null?void 0:r.data)==null?void 0:n.message)||"Password reset failed. Please try again.";c.error(R),(g=(t=w.response)==null?void 0:t.data)!=null&&g.errors&&f(w.response.data.errors)}finally{x(!1)}}};return N?s.jsx("div",{className:"min-h-screen pt-20 pb-12 flex flex-col justify-center",children:s.jsx(E,{fullScreen:!0,text:"Verifying reset token..."})}):s.jsx("div",{className:"min-h-screen pt-20 pb-12 flex flex-col justify-center",children:s.jsx("div",{className:"container-custom max-w-md mx-auto",children:s.jsxs($,{className:"p-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-2 text-gradient",children:"Reset Password"}),s.jsx("p",{style:{color:"var(--secondary-text)"},children:"Enter your new password below"})]}),s.jsxs("form",{onSubmit:L,children:[s.jsx(P,{label:"New Password",type:"password",name:"password",value:a.password,onChange:h,placeholder:"••••••••",error:u.password,disabled:d,required:!0}),s.jsx(P,{label:"Confirm New Password",type:"password",name:"confirmPassword",value:a.confirmPassword,onChange:h,placeholder:"••••••••",error:u.confirmPassword,disabled:d,required:!0}),s.jsx(T,{type:"submit",variant:"gradient",className:"w-full",disabled:d,children:d?"Resetting...":"Reset Password"}),s.jsx("div",{className:"mt-6 text-center",children:s.jsxs("p",{style:{color:"var(--secondary-text)"},children:["Remember your password?"," ",s.jsx(V,{to:"/login",className:"link",children:"Sign in"})]})})]})]})})})};export{U as default};
